@page "/inventory/{InventoryId:int}"
@using invMed.Data
@using invMed.Data.Enums
@using invMed.Controls.Inventory
@inject InventoryService inventoryService
@inject IDialogService DialogService


@attribute [Authorize(Roles = "Admin")]

<MudText Typo="Typo.h5" Color="Color.Primary" Class="mb-4 mt-4">Inwentaryzacja</MudText>
<MudGrid>
    <MudItem xs="12" sm="12" md="8" lg="9">
        <MudPaper Elevation="25" Class="pa-4" Style="min-height: 680px;">
            <MudText Typo="Typo.h6">Inwentaryzacja</MudText>
           
        </MudPaper>
    </MudItem>

    <MudItem xs="12" sm="12" md="4" lg="3">
        <MudPaper Elevation="25" Class="pa-4" Style="min-height: 380px;">
            <MudText Typo="Typo.h6">Szczegóły inwentaryzacji</MudText>
            @if (inventoryDetails is not null)
            {
                <MudText Class="mt-4"><b>Typ:</b> @inventoryDetails.Type.GetDisplayName()</MudText>
                <MudText><b>Opis:</b> @inventoryDetails.Description</MudText>
                <MudText><b>Stan:</b> @inventoryDetails.State.GetDisplayName()</MudText>
                <MudText><b>Data rozpoczęcia:</b> @inventoryDetails.StartDate</MudText>
                if (inventoryDetails.PlannedEndDate is not null)
                {
                    <MudText><b>Data planowanego zakończenia:</b> @inventoryDetails.PlannedEndDate</MudText>
                }
                <MudText><b>Ilość zeskanowanych produktów:</b> @inventoryDetails.ScannedNumber</MudText>
                <MudText><b>Ilość produktów do zeskanowania:</b> @inventoryDetails.ItemsNumberScan</MudText>
                <MudText><b>Postęp:</b> @inventoryDetails.Progress %</MudText>
            }
            else
            {
                <MudProgressLinear Color="Color.Primary" Indeterminate="true" Class="my-7" />
            }
        </MudPaper>
    </MudItem>

</MudGrid>


@code {
    [Parameter]
    public int InventoryId { get; set; }

    private InventoryDetailsView inventoryDetails;

    protected override async Task OnInitializedAsync()
    {
        inventoryDetails = await inventoryService.GetInventoryDetailsViewById(InventoryId);
    }
}